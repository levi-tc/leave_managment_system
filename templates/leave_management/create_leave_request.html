{% extends 'base.html' %}

{% block title %}Submit Leave Request - App-Concedii{% endblock %}

{% block content %}
<h2 class="mb-4">Submit Leave Request</h2>
<form method="post" class="needs-validation" novalidate>
    {% csrf_token %}
    <div class="row g-3">
        <div class="col-md-6">
            <label for="{{ form.leave_type.id_for_label }}" class="form-label">{{ form.leave_type.label }}</label>
            {{ form.leave_type|add_class:"form-select" }}
            <div class="invalid-feedback">{{ form.leave_type.errors }}</div>
        </div>
        <div class="col-md-6" id="other-leave-type" style="display: none;">
            <label for="{{ form.other_leave_type.id_for_label }}" class="form-label">{{ form.other_leave_type.label }}</label>
            {{ form.other_leave_type|add_class:"form-control" }}
            <div class="invalid-feedback">{{ form.other_leave_type.errors }}</div>
        </div>
        <div class="col-md-4">
            <label for="{{ form.start_date.id_for_label }}" class="form-label">{{ form.start_date.label }}</label>
            {{ form.start_date|add_class:"form-control" }}
            <div class="invalid-feedback">{{ form.start_date.errors }}</div>
        </div>
        <div class="col-md-4">
            <label for="{{ form.end_date.id_for_label }}" class="form-label">{{ form.end_date.label }}</label>
            {{ form.end_date|add_class:"form-control" }}
            <div class="invalid-feedback">{{ form.end_date.errors }}</div>
        </div>
        <div class="col-md-4">
            <label for="{{ form.return_date.id_for_label }}" class="form-label">{{ form.return_date.label }}</label>
            {{ form.return_date|add_class:"form-control" }}
            <div class="invalid-feedback">{{ form.return_date.errors }}</div>
        </div>
        <div class="col-md-6">
            <label for="{{ form.total_days.id_for_label }}" class="form-label">{{ form.total_days.label }}</label>
            {{ form.total_days|add_class:"form-control" }}
            <div class="invalid-feedback">{{ form.total_days.errors }}</div>
        </div>
        <div class="col-md-6">
            <label for="{{ form.contact_during_leave.id_for_label }}" class="form-label">{{ form.contact_during_leave.label }}</label>
            {{ form.contact_during_leave|add_class:"form-control" }}
            <div class="invalid-feedback">{{ form.contact_during_leave.errors }}</div>
        </div>
        <div class="col-12">
            <label for="{{ form.reason.id_for_label }}" class="form-label">{{ form.reason.label }}</label>
            {{ form.reason|add_class:"form-control" }}
            <div class="invalid-feedback">{{ form.reason.errors }}</div>
        </div>
    </div>
    <div class="mt-4">
        <button type="submit" class="btn btn-primary">Submit Leave Request</button>
        <a href="{% url 'leave_request_list' %}" class="btn btn-secondary">Cancel</a>
    </div>
</form>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    var leaveTypeSelect = document.getElementById('id_leave_type');
    var otherLeaveTypeDiv = document.getElementById('other-leave-type');

    leaveTypeSelect.addEventListener('change', function() {
        if (this.value === 'other') {
            otherLeaveTypeDiv.style.display = 'block';
        } else {
            otherLeaveTypeDiv.style.display = 'none';
        }
    });

    // Bootstrap form validation
    var forms = document.querySelectorAll('.needs-validation');
    Array.prototype.slice.call(forms).forEach(function (form) {
        form.addEventListener('submit', function (event) {
            if (!form.checkValidity()) {
                event.preventDefault();
                event.stopPropagation();
            }
            form.classList.add('was-validated');
        }, false);
    });
});
</script>
{% endblock %}